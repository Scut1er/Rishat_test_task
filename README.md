# Инструкции по тестированию Django Stripe Shop

## Быстрый тест основного функционала

### 1. Настройка Stripe ключей

Перед тестированием убедитесь, что у вас есть тестовые ключи Stripe:

1. Зарегистрируйтесь на https://stripe.com/
2. Перейдите в Dashboard → Developers → API keys
3. Скопируйте Publishable key и Secret key (режим Test)

### 2. Запуск приложения

#### Вариант A: Локальный запуск
```bash
# Создайте .env файл
cp env_example.txt .env

# Добавьте ваши Stripe ключи в .env
# STRIPE_PUBLISHABLE_KEY=pk_test_ваш_ключ
# STRIPE_SECRET_KEY=sk_test_ваш_ключ

# Запустите сервер
python manage.py runserver
```

#### Вариант B: Docker
```bash
# Создайте .env файл с вашими Stripe ключами
cp env_example.txt .env

# Отредактируйте .env и добавьте ваши Stripe ключи:
# SECRET_KEY=django-insecure-your-secret-key-here-change-in-production
# DEBUG=True
# STRIPE_PUBLISHABLE_KEY=pk_test_ваш_ключ
# STRIPE_SECRET_KEY=sk_test_ваш_ключ

# Запустите Docker
docker-compose up --build
```

### 3. Тестовые данные

Приложение автоматически загружает тестовые данные:
- 4 товара (MacBook Pro, iPhone, AirPods, Magic Mouse)
- 1 заказ с несколькими товарами
- Скидки и налоги

### 4. Тестирование URL endpoints

1. **Админ панель**: http://localhost:8000/admin/
   - Логин: admin
   - Пароль: admin

2. **Просмотр товара**: http://localhost:8000/item/1/
   - Отображает страницу MacBook Pro с кнопкой покупки

3. **API получения session ID**: http://localhost:8000/buy/1/
   - Возвращает JSON с session_id для Stripe

4. **Просмотр заказа**: http://localhost:8000/order/1/
   - Отображает заказ с несколькими товарами

5. **API для заказа**: http://localhost:8000/buy_order/1/
   - Возвращает JSON с session_id для заказа

### 5. Тестирование платежей

1. Перейдите на страницу товара: http://localhost:8000/item/1/
2. Нажмите кнопку "Купить"
3. Вас перенаправит на Stripe Checkout
4. Используйте тестовую карту: `4242 4242 4242 4242`
5. Заполните остальные поля (любые данные)
6. После успешной оплаты вас перенаправит на страницу успеха

### 6. Тестовые карты Stripe

- **Успешная оплата**: 4242 4242 4242 4242
- **Требует аутентификации**: 4000 0025 0000 3155
- **Отклоненная карта**: 4000 0000 0000 9995
- **Недостаточно средств**: 4000 0000 0000 9995

### 7. Проверка функционала в админке

1. Войдите в админку: http://localhost:8000/admin/
2. Проверьте разделы:
   - **Товары**: Просмотр и создание товаров
   - **Заказы**: Просмотр заказов с товарами
   - **Скидки**: Управление скидками
   - **Налоги**: Управление налогами

### 8. Создание нового товара

1. В админке перейдите в "Товары" → "Добавить товар"
2. Заполните поля:
   - Название: "Test Product"
   - Описание: "Test Description"
   - Цена: 99.99
3. Сохраните товар
4. Перейдите на http://localhost:8000/item/{новый_id}/

### 9. Создание нового заказа

1. В админке перейдите в "Заказы" → "Добавить заказ"
2. Сохраните пустой заказ
3. Добавьте товары через inline формы
4. Перейдите на http://localhost:8000/order/{новый_id}/


### 10. Производственный деплой

Для деплоя на продакшн:
1. Смените DEBUG=False
2. Настройте ALLOWED_HOSTS
3. Используйте реальные Stripe ключи
4. Настройте HTTPS
5. Используйте PostgreSQL вместо SQLite 